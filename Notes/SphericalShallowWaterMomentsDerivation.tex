\documentclass[oneside]{article}
\usepackage[letterpaper, margin=2cm]{geometry}
\usepackage{Notes}

\begin{document}
\begin{center}
  \textbf{\Large{Derivation of Shallow Water Moment Equations in Spherical
      Coordinates}} \\
\end{center}

First I will define the transformation from cartesian \(\v{x} = \br{x, y, z}\) to
spherical coordinates, \(\v{r} = \br{r, \theta, \phi}\)
\begin{gather}
  r = s_1(x, y, z) = \sqrt{x^2 + y^2 + z^2} \\
  \theta = s_2(x, y, z) = \arctan{\frac{y}{x}} \\
  \phi = s_3(x, y, z) = \arctan{\frac{\sqrt{x^2 + y^2}}{z}}
  = \arccos{\frac{z}{\sqrt{x^2 + y^2 + z^2}}} \\
  \v{s}(\v{x}) = \v{s}(x, y, z) = \br{s_1(x, y, z), s_2(x, y, z), s_3(x, y, z)} \\
  x = c_1(r, \theta, \phi) = r \cos{\theta} \sin{\phi} \\
  y = c_2(r, \theta, \phi) = r \sin{\theta} \sin{\phi} \\
  z = c_3(r, \theta, \phi) = r \cos{\phi} \\
  \v{c}(\v{r}) = \v{c}(r, \theta, \phi) = \br{c_1(r, \theta, \phi),
    c_2(r, \theta, \phi), c_3(r, \theta, \phi)}
\end{gather}

The projections from cartesian to spherical coordinates can be computed using the
following unit vectors
\begin{gather}
  \hat{r} = \cos{\theta} \sin{\phi} \hat{x} + \sin{\theta} \sin{\phi} \hat{y}
    + \cos{\phi} \hat{z} \\
  \hat{\theta} = -\sin{\theta} \hat{x} + \cos{\theta} \hat{y} \\
  \hat{\phi} = \cos{\theta} \cos{\phi} \hat{x} + \sin{\theta} \cos{\phi} \hat{y}
    - \sin{\phi} \hat{z} \\
  \hat{x} = \cos{\theta} \sin{\phi} \hat{r} - \sin{\theta} \hat{\theta}
    + \cos{\theta} \cos{\phi} \hat{\phi}\\
  \hat{y} = \sin{\theta} \sin{\phi} \hat{r} + \cos{\theta} \hat{\theta}
    + \sin{\theta} \cos{\phi} \hat{\phi}\\
  \hat{z} = \cos{\phi} \hat{r} - \sin{\phi} \hat{\phi} \\
\end{gather}

The partial derivatives of the transformation to spherical coordinates are needed, when
considering differential equations.
\begin{gather}
  s_{1,x} = \frac{1}{2} \frac{1}{\sqrt{x^2 + y^2 + z^2}} 2x = \cos{\theta} \sin{\phi} \\
  s_{1,y} = \frac{1}{2} \frac{1}{\sqrt{x^2 + y^2 + z^2}} 2y = \sin{\theta} \sin{\phi} \\
  s_{1,z} = \frac{1}{2} \frac{1}{\sqrt{x^2 + y^2 + z^2}} 2z = \cos{\phi} \\
\end{gather}
\begin{gather}
  s_{2,x} = \frac{1}{1 + \frac{y^2}{x^2}} \p{- \frac{y}{x^2}} \\
    = \frac{1}{1 + \frac{r^2 \sin[2]{\theta} \sin[2]{\phi}}{r^2 \cos[2]{\theta} \sin[2]{\phi}}}
    \p{-\frac{r \sin{\theta} \sin{\phi}}{r^2 \cos[2]{\theta} \sin[2]{\phi}}} \\
    = \frac{1}{1 + \frac{\sin[2]{\theta}}{\cos[2]{\theta}}}
      \p{-\frac{\sin{\theta}}{r \cos[2]{\theta} \sin{\phi}}} \\
    = -\frac{1}{1 + \frac{1 - \cos[2]{\theta}}{\cos[2]{\theta}}}
      \frac{\sin{\theta}}{r \cos[2]{\theta} \sin{\phi}} \\
    = -\cos[2]{\theta} \frac{\sin{\theta}}{r \cos[2]{\theta} \sin{\phi}} \\
    = - \frac{\sin{\theta}}{r \sin{\phi}} \\
  s_{2,y} = \frac{1}{1 + \frac{y^2}{x^2}} \p{\frac{1}{x}} \\
    = \cos[2]{\theta} \frac{1}{r \cos{\theta} \sin{\phi}} \\
    = \frac{\cos{\theta}}{r \sin{\phi}} \\
  s_{2,z} = 0 \\
\end{gather}
\begin{gather}
  s_{3,x} = \frac{1}{1 + \frac{x^2 + y^2}{z^2}} \frac{1}{2}
    \frac{2x}{z \sqrt{x^2 + y^2}} \\
    = \frac{1}{1 + \frac{r^2 \cos[2]{\theta} \sin[2]{\phi} + r^2 \sin[2]{\theta} \sin[2]{\phi}}{r^2 \cos[2]{\phi}}}
    \frac{r \cos{\theta} \sin{\phi}}{r \cos{\phi} \sqrt{r^2 \cos[2]{\theta} \sin[2]{\phi} + r^2 \sin[2]{\theta} \sin[2]{\phi}}} \\
    = \frac{1}{1 + \frac{\sin[2]{\phi}}{\cos[2]{\phi}}}
    \frac{\cos{\theta}}{r \cos{\phi}} \\
    = \frac{1}{1 + \frac{1 - \cos[2]{\phi}}{\cos[2]{\phi}}}
    \frac{\cos{\theta}}{r \cos{\phi}} \\
    = \cos[2]{\phi} \frac{\cos{\theta}}{r \cos{\phi}} \\
    = \frac{\cos{\theta} \cos{\phi}}{r} \\
  s_{3,y} = \frac{1}{1 + \frac{x^2 + y^2}{z^2}} \frac{1}{2}
    \frac{2y}{z \sqrt{x^2 + y^2}} \\
    = \cos[2]{\phi} \frac{r \sin{\theta} \sin{\phi}}{r \cos{\phi} r \sin{\phi}} \\
    = \frac{\sin{\theta} \cos{\phi}}{r} \\
  s_{3,z} = -\frac{1}{1 + \frac{x^2 + y^2}{z^2}} \frac{\sqrt{x^2 + y^2}}{z^2} \\
    = -\cos[2]{\phi} \frac{r \sin{\phi}}{r^2 \cos[2]{\phi}} \\
    = - \frac{\sin{\phi}}{r} \\
\end{gather}

The derivative with respect to a cartesian coordinate, can be expressed in terms of the
spherical coordinate derivatives using the chain rule.
Consider a function of spherical coordinates, \(f(r, \theta, \phi)\), then
\begin{equation}
  \pda{f(\v{s}(\v{x}))}{t} = \pd{f}{r} \pd{s_1}{t} + \pd{f}{\theta} \pd{s_2}{t}
  + \pd{f}{\phi} \pd{s_3}{t}
\end{equation}
where \(t = x, y, \text{or} z\)

Now let's consider the Navier Stokes equation
The velocities in cartesian coordinates are given by \(\br{u, v, w} = \v{u}\), then the
cartesian Navier Stokes equations are
\begin{gather}
  \pd{u}{x} + \pd{v}{y} + \pd{w}{z} = 0 \\
  \pd{u}{t} + \pda{u^2}{x} + \pda{uv}{y} + \pda{uw}{z} = -\frac{1}{\rho} \pd{p}{x}
    + \pd{\sigma_{xx}}{x} + \pd{\sigma_{xy}}{y} + \pd{\sigma_{xz}}{z} + g_x \\
  \pd{v}{t} + \pda{uv}{x} + \pda{v^2}{y} + \pda{vw}{z} = -\frac{1}{\rho} \pd{p}{y}
    + \pd{\sigma_{xy}}{x} + \pd{\sigma_{yy}}{y} + \pd{\sigma_{yz}}{z} + g_y \\
  \pd{w}{t} + \pda{uw}{x} + \pda{vw}{y} + \pda{w^2}{z} = -\frac{1}{\rho} \pd{p}{z}
    + \pd{\sigma_{xz}}{x} + \pd{\sigma_{yz}}{y} + \pd{\sigma_{zz}}{z} + g_z \\
\end{gather}

In spherical coordinates we represent the velocities as
\(\br{u_r, u_{\theta}, u_{\phi}} = \v{u}_r\).
Using the unit vectors we can write these velocities in terms of the cartesian
velocities.
\begin{gather}
  u_r = \cos{\theta} \sin{\phi} u + \sin{\theta} \sin{\phi} v + \cos{\phi} w \\
  u_{\theta} = -\sin{\theta} u + \cos{\theta} w \\
  u_{\phi} = \cos{\theta} \cos{\phi} u + \sin{\theta} \cos{\phi} v - \sin{\phi} w
\end{gather}
We can also write the cartesian velocities in terms of the spherical velocities.
\begin{gather}
  u = \cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi} \\
  v = \sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
  + \sin{\theta} \cos{\phi} u_{\phi} \\
  w = \cos{\phi} u_r - \sin{\phi} u_{\phi}
\end{gather}

Now we can express the continuity equation in spherical coordinates
\begin{gather}
  \pd{u}{x} + \pd{v}{y} + \pd{w}{z} = 0 \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{x} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{y} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{z} = 0 \\
\end{gather}
\begin{gather}
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{r} \pd{s_1}{x} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\theta} \pd{s_2}{x} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\phi} \pd{s_3}{x} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{r} \pd{s_1}{y} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\theta} \pd{s_2}{y} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\phi} \pd{s_3}{y} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{r} \pd{s_1}{z} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{\theta} \pd{s_2}{z} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{\phi} \pd{s_3}{z} = 0 \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{r} \cos{\theta} \sin{\phi} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\theta} \frac{-\sin{\theta}}{r \sin{\phi}} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\phi} \frac{\cos{\theta} \cos{\phi}}{r} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{r} \sin{\theta} \sin{\phi} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\theta} \frac{\cos{\theta}}{r \sin{\phi}} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\phi} \frac{\sin{\theta} \cos{\phi}}{r} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{r} \cos{\phi} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{\theta} 0 \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{\phi} \frac{-\sin{\phi}}{r} = 0 \\
\end{gather}
\begin{gather}
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{r} \cos{\theta} \sin{\phi} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\theta} \frac{-\sin{\theta}}{r \sin{\phi}} \\
  \pda{\cos{\theta} \sin{\phi} u_r - \sin{\theta} u_{\theta}
    + \cos{\theta} \cos{\phi} u_{\phi}}{\phi} \frac{\cos{\theta} \cos{\phi}}{r} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{r} \sin{\theta} \sin{\phi} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\theta} \frac{\cos{\theta}}{r \sin{\phi}} \\
  + \pda{\sin{\theta} \sin{\phi} u_r + \cos{\theta} u_{\theta}
    + \sin{\theta} \cos{\phi} u_{\phi}}{\phi} \frac{\sin{\theta} \cos{\phi}}{r} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{r} \cos{\phi} \\
  + \pda{\cos{\phi} u_r - \sin{\phi} u_{\phi}}{\phi} \frac{-\sin{\phi}}{r} = 0 \\
\end{gather}
Now I will consider the terms of each derivative of each velocity individually,
\begin{gather}
  \intertext{\(\pd{u_r}{r}\)}
    \cos[2]{\theta} \sin[2]{\phi} \pd{u_r}{r} + \sin[2]{\theta} \sin[2]{\phi} \pd{u_r}{r}
    + \cos[2]{\phi} \pd{u_r}{r}
    = \sin[2]{\phi} \pd{u_r}{r} + \cos[2]{\phi} \pd{u_r}{r}
    = \pd{u_r}{r}
  \intertext{\(\pd{u_{\theta}}{r}\)}
    - \sin{\theta} \cos{\theta} \sin{\phi} \pd{u_{\theta}}{r}
    + \cos{\theta} \sin{\theta} \sin{\phi} \pd{u_{\theta}}{r} = 0
  \intertext{\(\pd{u_{\phi}}{r}\)}
    \cos[2]{\theta} \cos{\phi} \sin{\phi} \pd{u_{\phi}}{r}
    + \sin[2]{\theta} \cos{\phi} \sin{\phi} \pd{u_{\phi}}{r}
    - \sin{\phi} \cos{\phi} \pd{u_{\phi}}{r} \\
    = \cos{\phi} \sin{\phi} \pd{u_{\phi}}{r}
    - \sin{\phi} \cos{\phi} \pd{u_{\phi}}{r} = 0
  \intertext{\(\pd{u_r}{\theta}\)}
    - \frac{\sin{\theta}}{r} \pda{\cos{\theta} u_r}{\theta}
    + \frac{\cos{\theta}}{r} \pda{\sin{\theta} u_r}{\theta} \\
    = - \frac{\sin{\theta} \cos{\theta}}{r} \pd{u_r}{\theta}
    + \frac{\sin[2]{\theta}}{r} u_r
    + \frac{\cos{\theta} \sin{\theta}}{r} \pd{u_r}{\theta}
    + \frac{\cos[2]{\theta}}{r} u_r = \frac{u_r}{r}
  \intertext{\(\pd{u_{\theta}}{\theta}\)}
    \frac{\sin{\theta}}{r \sin{\phi}} \pda{\sin{\theta} u_{\theta}}{\theta}
    + \frac{\cos{\theta}}{r \sin{\phi}} \pda{\cos{\theta} u_{\theta}}{\theta}
    = \\
    \frac{\sin{\theta}}{r \sin{\phi}} \p{\sin{\theta} \pd{u_{\theta}}{\theta} + \cos{\theta} u_{\theta}}
    + \frac{\cos{\theta}}{r \sin{\phi}} \p{\cos{\theta} \pd{u_{\theta}}{\theta} - \sin{\theta} u_{\theta}}
    = \\
    \frac{\sin[2]{\theta}}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
    + \frac{\cos[2]{\theta}}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
    = \frac{1}{r \sin{\phi}} \pd{u_{\theta}}{\theta} \\
  \intertext{\(\pd{u_{\phi}}{\theta}\)}
    - \frac{\sin{\theta} \cos{\phi}}{r \sin{\phi}} \pda{\cos{\theta} u_{\phi}}{\theta}
    + \frac{\cos{\theta} \cos{\phi}}{r \sin{\phi}} \pda{\sin{\theta} u_{\phi}}{\theta} = \\
    - \frac{\sin{\theta} \cos{\phi}}{r \sin{\phi}} \p{\cos{\theta} \pd{u_{\phi}}{\theta} - \sin{\theta} u_{\phi}}
    + \frac{\cos{\theta} \cos{\phi}}{r \sin{\phi}} \p{\sin{\theta} \pd{u_{\phi}}{\theta} + \cos{\theta} u_{\phi}} = \\
    \frac{\sin[2]{\theta} \cos{\phi}}{r \sin{\phi}} u_{\phi}
    + \frac{\cos[2]{\theta} \cos{\phi}}{r \sin{\phi}} u_{\phi} =
    \frac{\cos{\phi}}{r \sin{\phi}} u_{\phi}
  \intertext{\(\pd{u_r}{\phi}\)}
    \frac{\cos[2]{\theta} \cos{\phi}}{r} \pda{\sin{\phi} u_r}{\phi}
    + \frac{\sin[2]{\theta} \cos{\phi}}{r} \pda{\sin{\phi} u_r}{\phi}
    - \frac{\sin{\phi}}{r} \pda{\cos{\phi} u_r}{\phi} = \\
    \frac{\cos{\phi}}{r} \pda{\sin{\phi} u_r}{\phi}
    - \frac{\sin{\phi}}{r} \pda{\cos{\phi} u_r}{\phi} = \\
    \frac{\cos{\phi}}{r} \p{\sin{\phi} \pd{u_r}{\phi} + \cos{\phi} u_r}
    - \frac{\sin{\phi}}{r} \p{\cos{\phi} \pd{u_r}{\phi} - \sin{\phi} u_r} = \\
    \frac{\cos[2]{\phi}}{r} u_r + \frac{\sin[2]{\phi}}{r} u_r =
    \frac{1}{r} u_r
  \intertext{\(\pd{u_{\theta}}{\phi}\)}
    - \frac{\cos{\theta} \sin{\theta} \cos{\phi}}{r} \pd{u_{\theta}}{\phi}
    + \frac{\sin{\theta} \cos{\theta} \cos{\phi}}{r} \pd{u_{\theta}}{\phi} = 0
  \intertext{\(\pd{u_{\phi}}{\phi}\)}
    \frac{\cos[2]{\theta} \cos{\phi}}{r} \pda{\cos{\phi} u_{\phi}}{\phi}
    + \frac{\sin[2]{\theta} \cos{\phi}}{r} \pda{\cos{\phi} u_{\phi}}{\phi}
    + \frac{\sin{\phi}}{r} \pda{\sin{\phi} u_{\phi}}{\phi} = \\
    \frac{\cos{\phi}}{r} \pda{\cos{\phi} u_{\phi}}{\phi}
    + \frac{\sin{\phi}}{r} \pda{\sin{\phi} u_{\phi}}{\phi} = \\
    \frac{\cos{\phi}}{r} \p{\cos{\phi} \pd{u_{\phi}}{\phi} - \sin{\phi} u_{\phi}}
    + \frac{\sin{\phi}}{r} \p{\sin{\phi} \pd{u_{\phi}}{\phi} + \cos{\phi} u_{\phi}} = \\
    \frac{\cos[2]{\phi}}{r} \pd{u_{\phi}}{\phi}
    + \frac{\sin[2]{\phi}}{r} \pd{u_{\phi}}{\phi} =
    \frac{1}{r} \pd{u_{\phi}}{\phi}
\end{gather}
The simplified continuity equation is thus
\begin{gather}
  \pd{u_r}{r} + \frac{u_r}{r} + \frac{1}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
  + \frac{\cos{\phi}}{r \sin{\phi}} u_{\phi} + \frac{1}{r} u_r
  + \frac{1}{r} \pd{u_{\phi}}{\phi} = 0 \\
  \pd{u_r}{r} + 2\frac{u_r}{r} + \frac{1}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
  + \frac{1}{r} \pd{u_{\phi}}{\phi} + \frac{\cos{\phi}}{r \sin{\phi}} u_{\phi} = 0 \\
  \intertext{Using the product rule this can also be written as}
  \frac{1}{r^2}\pda{r^2 u_r}{r} + \frac{1}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
  + \frac{1}{r \sin{\phi}} \pda{\sin{\phi} u_{\phi}}{\phi} = 0 \\
\end{gather}

% \begin{gather*}
%   \pd{u}{t} + \pda{u^2}{x} + \pda{uv}{y} + \pda{uw}{z} = \\
% \end{gather*}


Shallow Water in Spherical Coordinates
R radius, \((\theta, \phi)\), longitude and latitude
\begin{gather}
  h_t + \frac{1}{R \cos{\phi}} \p{h u_{\theta}}_{\theta}
    + \frac{1}{R \cos{\phi}} \p{h u_{\phi} \cos{\phi}}_{\phi} = 0 \\
  \p{h u_{\theta}}_t + \frac{1}{R \cos{\phi}} \p{h u_{\theta}^2 + \frac{1}{2} g h^2}_{\theta}
    + \frac{1}{R} \p{h u_{\theta} u_{\phi}}
    - 2 \frac{h u_{\theta} u_{\phi}}{R} \tan{\phi} = 0 \\
  \p{h u_{\phi}}_{\phi} + \frac{1}{R \cos{\phi}} \p{h u_{\theta} u_{\phi}}_{\theta}
    + \frac{1}{R} \p{h u_{\phi}^2 + \frac{1}{2} g h^2}_{\phi}
    + \frac{h u_{\theta}^2 - h u_{\phi}^2}{R} \tan{\phi} = 0
\end{gather}

Navier Stokes Equations in Spherical Coordinates
r radius, \((\theta, \phi)\) azimuth, and polar angle,
\(\theta = \arctan{y/x}, \phi = \arctan{\frac{\sqrt{x^2 + y^2}}{z}}\)

\begin{gather}
  \frac{1}{r^2}\pda{r^2 u_r}{r} + \frac{1}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
    + \frac{1}{r \sin{\phi}} \pda{\sin{\phi} u_{\phi}}{\phi} = 0 \\
  \pd{u_r}{t} + u_r \pd{u_r}{r} + \frac{u_{\theta}}{r \sin{\phi}} \pd{u_r}{\theta}
    + \frac{u_{\phi}}{r} \pd{u_r}{\phi} - \frac{u_{\theta}^2 + u_{\phi}^2}{r}
    = - \frac{1}{\rho} \pd{p}{r} + g_r \\
  \pd{u_{\theta}}{t} + u_r \pd{u_{\theta}}{r}
    + \frac{u_{\theta}}{r \sin{\phi}} \pd{u_{\theta}}{\theta}
    + \frac{u_{\phi}}{r} \pd{u_{\theta}}{\phi}
    + \frac{u_r u_{\theta}}{r}
    + \frac{u_{\theta} u_{\phi} \cot{\phi}}{r}
    = - \frac{1}{\rho r \sin{\phi}} \pd{p}{\theta} + g_{\theta} \\
  \pd{u_{\phi}}{t} + u_r \pd{u_{\phi}}{r}
    + \frac{u_\theta}{r \sin{\phi}} \pd{u_{\phi}}{\theta}
    + \frac{u_{\phi}}{r} \pd{u_{\phi}}{\phi}
    + \frac{u_r u_{\phi}}{r}
    - \frac{u_{\theta}^2 \cot{\phi}}{r}
    = - \frac{1}{\rho r} \pd{p}{\phi} + g_{\phi}
\end{gather}
Kinematic Boundary Condition, \(h_s(t, \theta, \phi)\), \(h_b(t, \theta, \phi)\)
\(u_{\theta/\phi/r}(t, \theta, \phi, r)\)
\begin{gather}
  \pd{h_s}{t} + u_{\theta}(t, \theta, \phi, h_s) \pd{h_s}{\theta}
    + u_{\phi}(t, \theta, \phi, h_s) \pd{h_s}{\phi}
    = u_r(t, \theta, \phi, h_s) \\
  \pd{h_b}{t} + u_{\theta}(t, \theta, \phi, h_b) \pd{h_b}{\theta}
    + u_{\phi}(t, \theta, \phi, h_b) \pd{h_b}{\phi}
    = u_r(t, \theta, \phi, h_b) \\
\end{gather}

Dimensional Analysis
\[
  r = R \hat{r} \quad h = H \hat{h} \quad \frac{H}{R} = \epsilon
\]
\[
  u_{\theta} = U \hat{u}_{\theta} \quad u_{\phi} = U \hat{u}_{\phi}
  \quad u_r = U_r \hat{u}_r
\]
\[
  t = T \hat{t} = \frac{R}{U} \hat{t} \quad p = \rho g H \hat{p}
\]

\begin{gather}
  \frac{1}{R^2 \hat{r}^2} \frac{1}{R} \pda{R^2 \hat{r}^2 \epsilon U \hat{u}_r}{\hat{r}}
    + \frac{1}{R \hat{r} \sin{\phi}} \pd{U \hat{u}_{\theta}}{\theta}
    + \frac{1}{R \hat{r} \sin{\phi}} \pda{\sin{\phi} U \hat{u}_{\phi}}{\phi} = 0 \\
  \frac{U_r}{T} \pd{\hat{u}_r}{\hat{t}} + U_r \hat{u}_r \frac{U_r}{R} \pd{\hat{u}_r}{\hat{r}}
    + \frac{U \hat{u}_{\theta}}{R \hat{r} \sin{\phi}} U_r \pd{\hat{u}_r}{\theta}
    + \frac{U \hat{u}_{\phi}}{R \hat{r}} U_r \pd{\hat{u}_r}{\phi}
    - \frac{U^2}{R} \frac{\hat{u}_{\theta}^2 + \hat{u}_{\phi}^2}{r}
    = -\frac{1}{\rho} \rho g H \frac{1}{R} \pd{\hat{p}}{\hat{r}} + g_r \\
  \frac{U}{T} \pd{\hat{u}_{\theta}}{\hat{t}}
    + U_r \hat{u}_r \frac{U}{R} \pd{\hat{u}_{\theta}}{\hat{r}}
    + \frac{U \hat{u}_{\theta}}{R \hat{r} \sin{\phi}} U \pd{\hat{u}_{\theta}}{\theta}
    + \frac{U \hat{u}_{\phi}}{R \hat{r}} U \pd{\hat{u}_{\theta}}{\phi}
    + \frac{U_r \hat{u}_r U \hat{u}_{\theta}}{R \hat{r}}
    + \frac{U^2 \hat{u}_{\theta} \hat{u}_{\phi} \cot{\phi}}{R \hat{r}}
    = - \frac{1}{\rho R \hat{r} \sin{\phi}} \rho g H \pd{\hat{p}}{\theta}
    + g_{\theta} \\
  \frac{U}{T} \pd{\hat{u}_{\phi}}{\hat{t}}
    + U_r \hat{u}_r \frac{U}{R} \pd{\hat{u}_{\phi}}{\hat{r}}
    + \frac{U \hat{u}_\theta}{R \hat{r} \sin{\phi}} U \pd{\hat{u}_{\phi}}{\theta}
    + \frac{U \hat{u}_{\phi}}{R \hat{r}} U \pd{\hat{u}_{\phi}}{\phi}
    + \frac{U_r U \hat{u}_r \hat{u}_{\phi}}{R \hat{r}}
    - \frac{U^2 \hat{u}_{\theta}^2 \cot{\phi}}{R \hat{r}}
    = - \frac{1}{\rho R \hat{r}} \rho g H \pd{\hat{p}}{\phi} + g_{\phi}
\end{gather}

\(T = \frac{R}{U}\), \(U_r = \epsilon U\)
\begin{gather}
  \frac{\epsilon}{\hat{r}^2} \pda{\hat{r}^2 \hat{u}_r}{\hat{r}}
    + \frac{1}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{1}{\hat{r} \sin{\phi}} \pda{\sin{\phi} \hat{u}_{\phi}}{\phi} = 0 \\
  \frac{U^2}{R} \p{\epsilon \pd{\hat{u}_r}{\hat{t}}
    + \epsilon^2 \hat{u}_r \pd{\hat{u}_r}{\hat{r}}
    + \epsilon \frac{\hat{u}_{\theta}}{\hat{r} \sin{\phi}} \pd{\hat{u}_r}{\theta}
    + \epsilon \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_r}{\phi}
    - \frac{\hat{u}_{\theta}^2 + \hat{u}_{\phi}^2}{r}}
    = - g \frac{H}{R} \pd{\hat{p}}{\hat{r}} + g e_r \\
   \frac{U^2}{R} \p{\pd{\hat{u}_{\theta}}{\hat{t}}
    + \epsilon \hat{u}_r \pd{\hat{u}_{\theta}}{\hat{r}}
    +  \frac{\hat{u}_{\theta}}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\theta}}{\phi}
    + \epsilon \frac{\hat{u}_r \hat{u}_{\theta}}{\hat{r}}
    + \frac{\hat{u}_{\theta} \hat{u}_{\phi} \cot{\phi}}{\hat{r}}}
    = -\frac{g H}{R \hat{r} \sin{\phi}} \pd{\hat{p}}{\theta}
    + g e_{\theta} \\
  \frac{U^2}{R} \p{\pd{\hat{u}_{\phi}}{\hat{t}}
    + \epsilon \hat{u}_r \pd{\hat{u}_{\phi}}{\hat{r}}
    + \frac{\hat{u}_\theta}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\phi}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\phi}}{\phi}
    + \epsilon \frac{\hat{u}_r \hat{u}_{\phi}}{\hat{r}}
    - \frac{\hat{u}_{\theta}^2 \cot{\phi}}{\hat{r}}}
    = - \frac{g H}{R \hat{r}} \pd{\hat{p}}{\phi} + g e_{\phi}
\end{gather}

\(R = \frac{H}{\epsilon}\)
\begin{gather}
  \frac{\epsilon}{\hat{r}^2} \pda{\hat{r}^2 \hat{u}_r}{\hat{r}}
    + \frac{1}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{1}{\hat{r} \sin{\phi}} \pda{\sin{\phi} \hat{u}_{\phi}}{\phi} = 0 \\
  \epsilon \frac{U^2}{g H} \p{\epsilon \pd{\hat{u}_r}{\hat{t}}
    + \epsilon^2 \hat{u}_r \pd{\hat{u}_r}{\hat{r}}
    + \epsilon \frac{\hat{u}_{\theta}}{\hat{r} \sin{\phi}} \pd{\hat{u}_r}{\theta}
    + \epsilon \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_r}{\phi}
    - \frac{\hat{u}_{\theta}^2 + \hat{u}_{\phi}^2}{r}}
    = - \epsilon \pd{\hat{p}}{\hat{r}} + e_r \\
   \epsilon \frac{U^2}{g H} \p{\pd{\hat{u}_{\theta}}{\hat{t}}
    + \epsilon \hat{u}_r \pd{\hat{u}_{\theta}}{\hat{r}}
    +  \frac{\hat{u}_{\theta}}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\theta}}{\phi}
    + \epsilon \frac{\hat{u}_r \hat{u}_{\theta}}{\hat{r}}
    + \frac{\hat{u}_{\theta} \hat{u}_{\phi} \cot{\phi}}{\hat{r}}}
    = -\frac{\epsilon}{\hat{r} \sin{\phi}} \pd{\hat{p}}{\theta}
    + e_{\theta} \\
  \epsilon \frac{U^2}{g H} \p{\pd{\hat{u}_{\phi}}{\hat{t}}
    + \epsilon \hat{u}_r \pd{\hat{u}_{\phi}}{\hat{r}}
    + \frac{\hat{u}_\theta}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\phi}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\phi}}{\phi}
    + \epsilon \frac{\hat{u}_r \hat{u}_{\phi}}{\hat{r}}
    - \frac{\hat{u}_{\theta}^2 \cot{\phi}}{\hat{r}}}
    = - \frac{\epsilon}{\hat{r}} \pd{\hat{p}}{\phi} + e_{\phi}
\end{gather}

Drop \(\epsilon^2\) terms
\begin{gather}
  \frac{\epsilon}{\hat{r}^2} \pda{\hat{r}^2 \hat{u}_r}{\hat{r}}
    + \frac{1}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{1}{\hat{r} \sin{\phi}} \pda{\sin{\phi} \hat{u}_{\phi}}{\phi} = 0 \\
  -\epsilon \frac{U^2}{gH} \frac{\hat{u}_{\theta}^2 + \hat{u}_{\phi}^2}{r}
    = - \epsilon \pd{\hat{p}}{\hat{r}} + e_r \\
   \epsilon \frac{U^2}{g H} \p{\pd{\hat{u}_{\theta}}{\hat{t}}
    + \frac{\hat{u}_{\theta}}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\theta}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\theta}}{\phi}
    + \frac{\hat{u}_{\theta} \hat{u}_{\phi} \cot{\phi}}{\hat{r}}}
    = -\frac{\epsilon}{\hat{r} \sin{\phi}} \pd{\hat{p}}{\theta}
    + e_{\theta} \\
  \epsilon \frac{U^2}{g H} \p{\pd{\hat{u}_{\phi}}{\hat{t}}
    + \frac{\hat{u}_\theta}{\hat{r} \sin{\phi}} \pd{\hat{u}_{\phi}}{\theta}
    + \frac{\hat{u}_{\phi}}{\hat{r}} \pd{\hat{u}_{\phi}}{\phi}
    - \frac{\hat{u}_{\theta}^2 \cot{\phi}}{\hat{r}}}
    = - \frac{\epsilon}{\hat{r}} \pd{\hat{p}}{\phi} + e_{\phi}
\end{gather}

\end{document}